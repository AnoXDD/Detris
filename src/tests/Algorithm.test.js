/**
 * Created by Anoxic on 10/14/1917.
 */

import Immutable from "immutable";
import Algorithm from "../util/Algorithm";

import Block from "../state/Block";
import BlockType from "../enum/BlockType";
import Detromino from "../state/Detromino";
import DetrominoType from "../enum/DetrominoType";
import Direction from "../enum/Direction";

const charToType = {
  "1": BlockType.ORIGINAL,
  "2": BlockType.DETROMINO,
  "3": BlockType.TARGET,
  "4": BlockType.DETROMINO_TARGET,
  "5": BlockType.STALE,
};

const typeToChar = Object
  .keys(charToType)
  .reduce(function(obj, key) {
    obj[charToType[key]] = key;
    return obj;
  }, {});

function toMatrix(s) {
  return s
    .trim()
    .split("\n")
    .map((a, y) =>
      a.trim().split("").map((a, x) =>
        charToType[a] ? new Block({
          x, y,
          type: charToType[a],
        }) : null
      ));
}

/**
 * Converts an Immutable Map to string matrix (for comparison). Each line of
 * string represents a row
 * @param {grid} grid
 */
function gameGridToMatrixString(grid) {
  return Algorithm.convertGridToArray(grid)
    .map(r => r.map(b => b ? (typeToChar[b.get("type")] || "0") : "0").join(""))
    .join("\n");
}

describe("Test findNextEditableBlock", () => {

  function exp(block, x, y) {
    expect(block.x()).toBe(x);
    expect(block.y()).toBe(y);
  }

  const matrix = toMatrix(
    `
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000000000
    0000020000
    0000000200
    0202020200
    0000022200
    0002000000
    0000002000
    0002020000
    `
  );

  const fn = Algorithm.findNextEditableBlock;
  const detromino = new Detromino({
    type: DetrominoType.I,
    x   : 3,
    y   : 12,
  });

  const L = Direction.LEFT;
  const D = Direction.DOWN;
  const U = Direction.UP;
  const R = Direction.RIGHT;

  const f = (x, y, direction) => fn(matrix, detromino, x, y, direction);

  describe("With adjacent blocks", () => {
    test("Down", () => {
      exp(f(5, 15, D), 5, 16);
    });

    test("Up", () => {
      exp(f(5, 16, U), 5, 15);
    });

    test("Left", () => {
      exp(f(6, 16, L), 5, 16);
    });

    test("Right", () => {
      exp(f(5, 16, R), 6, 16);
    });
  });

  test("Move vertically with gap", () => {
    let b = f(5, 15, U);
    exp(b, 5, 13);

    b = f(5, 13, D);
    exp(b, 5, 15);
  });

  describe("Move horizontally without an adjacent block", () => {

    test("Move left with block above the gap", () => {
      exp(f(6, 18, L), 5, 16);
    });

    test("Move right with block above the gap", () => {
      exp(f(5, 19, R), 6, 18);
    });

    test("Move right with no block above the gap", () => {
      exp(f(5, 15, R), 6, 16);
    });

  });

  describe("Move horizontally with an adjacent empty column", () => {

    test("Move with block on the same row", () => {
      exp(f(5, 15, L), 3, 15);
      exp(f(3, 15, R), 5, 15);
    });

    test("Move with blocks on different rows", () => {
      exp(f(5, 16, L), 3, 15);
      exp(f(3, 17, R), 5, 16);
    });

  });

  describe("Hit the edge", () => {
    test("Down", () => {
      expect(f(5, 19, D)).toBeNull();
    });

    test("Up", () => {
      expect(f(5, 13, U)).toBeNull();
    });

    test("Left", () => {
      expect(f(3, 15, L)).toBeNull();
    });

    test("Right", () => {
      expect(f(6, 16, R)).toBeNull();
    });
  });
});

describe("Test isFitForNewDetrominoInEditor", () => {
  const matrix = toMatrix(
    // 0123456789
    "  0000000000\n" //0
    + "0000000000\n" //1
    + "0000000000\n" //2
    + "0000000000\n" //3
    + "0001110000\n" //4
    + "0011010000\n" //5
    + "0010001100\n" //6
    + "0010001000\n" //7
    + "0010001000\n" //8
    + "0011110000\n" //9
    + "0000000000\n" //10
    + "0000001110\n" //11
    + "0000111-10\n" //12
    + "00001---10\n" //13
    + "0000111110\n" //14
    + "0000000000\n" //15
    + "0000000000\n" //16
    + "0000000000\n" //17
    + "0000000000\n" //18
    + "0001100000\n" //19
    // 0123456789
  );

  const f = d => Algorithm.isFitForNewDetrominoInEditor(matrix, d);
  const d = (x, y, type) => new Detromino({x, y, type});

  test("No blocks above it", () => {
    expect(f(d(0, 18, DetrominoType.L))).toBeTruthy();
  });

  test("No blocks above it but overlapped", () => {
    expect(f(d(0, 19, DetrominoType.I))).toBeFalsy();
  });

  test("Blocks above it with plenty of space", () => {
    expect(f(d(5, 18, DetrominoType.O))).toBeTruthy();
  });

  test("Blocks above it with space exactly needed", () => {
    expect(f(d(5, 17, DetrominoType.I))).toBeTruthy();
  });

  test("Blocks above it with space exactly needed for tucked in (type L)",
    () => {
      expect(f(d(3, 16, DetrominoType.L))).toBeTruthy();
    });

  test("Blocks above it with space exactly needed for tucked in (type J)",
    () => {
      expect(f(d(7, 16, DetrominoType.J))).toBeTruthy();
    });

  test("Blocks above it with one block overlapped", () => {
    expect(f(d(8, 16, DetrominoType.O))).toBeFalsy();
  });

  test("Blocks that are overlapped already", () => {
    expect(f(d(4, 14, DetrominoType.T))).toBeFalsy();
  });

  test("Blocks that with only one line above it empty", () => {
    expect(f(d(3, 15, DetrominoType.L))).toBeFalsy();
  });

  test("Blocks in a cozy house", () => {
    expect(f(d(3, 7, DetrominoType.T))).toBeTruthy();
  });
});

describe("Test isTargetDetrominosValid", () => {

  const f = (matrix, x, y, type) => Algorithm.isTargetDetrominosValid(matrix,
    new Detromino({x, y, type}));

  test("Single detromino on the grid", () => {
    const m = toMatrix(
      // 0123456789
      "  0000000000\n" //0
      + "0000000000\n" //1
      + "0000000000\n" //2
      + "0000000000\n" //3
      + "0000000000\n" //4
      + "0000000000\n" //5
      + "0000000000\n" //6
      + "0000000000\n" //7
      + "0000000000\n" //8
      + "0000000000\n" //9
      + "0000000000\n" //10
      + "0000000000\n" //11
      + "0000000000\n" //12
      + "0000000000\n" //13
      + "0000000000\n" //14
      + "0001111000\n" //15
      + "0000000000\n" //16
      + "0000000000\n" //17
      + "0000000000\n" //18
      + "0000000000\n" //19
      // 0123456789
    );

    expect(f(m, 3, 15, DetrominoType.I)).toBeTruthy();
  });

  test("Single detromino on the grid at the bottom", () => {
    const m = toMatrix(
      // 0123456789
      "  0000000000\n" //0
      + "0000000000\n" //1
      + "0000000000\n" //2
      + "0000000000\n" //3
      + "0000000000\n" //4
      + "0000000000\n" //5
      + "0000000000\n" //6
      + "0000000000\n" //7
      + "0000000000\n" //8
      + "0000000000\n" //9
      + "0000000000\n" //10
      + "0000000000\n" //11
      + "0000000000\n" //12
      + "0000000000\n" //13
      + "0000000000\n" //14
      + "0000000000\n" //15
      + "0000000000\n" //16
      + "0000000000\n" //17
      + "0000000000\n" //18
      + "1111000000\n" //19
      // 0123456789
    );

    expect(f(m, 0, 19, DetrominoType.I)).toBeTruthy();
  });

  describe("Detromino without target blocks on top of blocks", () => {

    test("Immediately on top of original blocks", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0001000000\n" //16
        + "0001110000\n" //17
        + "0001110000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      expect(f(m, 3, 16, DetrominoType.L)).toBeTruthy();
    });

    test("On top of some random blocks", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0001111000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0001010000\n" //9
        + "0000100000\n" //10
        + "0000010100\n" //11
        + "0000100000\n" //12
        + "0000000000\n" //13
        + "0000000100\n" //14
        + "0001000000\n" //15
        + "0000000000\n" //16
        + "0010001000\n" //17
        + "0000010000\n" //18
        + "0010000000\n" //19
        // 0123456789
      );

      expect(f(m, 3, 6, DetrominoType.I)).toBeTruthy();
    });

  });

  describe("Detromino with target blocks", () => {

    describe("Expect false: not enough original blocks below it", () => {
      test("Shape I at the bottom", () => {
        const m = toMatrix(
          // 0123456789
          "  0000000000\n" //0
          + "0000000000\n" //1
          + "0000000000\n" //2
          + "0000000000\n" //3
          + "0000000000\n" //4
          + "0000000000\n" //5
          + "0000000000\n" //6
          + "0000000000\n" //7
          + "0000000000\n" //8
          + "0000000000\n" //9
          + "0000000000\n" //10
          + "0000000000\n" //11
          + "0000000000\n" //12
          + "0000000000\n" //13
          + "0000000000\n" //14
          + "0000000000\n" //15
          + "0000000000\n" //16
          + "0000000000\n" //17
          + "0000000000\n" //18
          + "1141000000\n" //19
          // 0123456789
        );

        expect(f(m, 0, 19, DetrominoType.I)).toBeFalsy();
      });

      test("Shape L at the bottom", () => {
        const m = toMatrix(
          // 0123456789
          "  0000000000\n" //0
          + "0000000000\n" //1
          + "0000000000\n" //2
          + "0000000000\n" //3
          + "0000000000\n" //4
          + "0000000000\n" //5
          + "0000000000\n" //6
          + "0000000000\n" //7
          + "0000000000\n" //8
          + "0000000000\n" //9
          + "0000000000\n" //10
          + "0000000000\n" //11
          + "0000000000\n" //12
          + "0000000000\n" //13
          + "0000000000\n" //14
          + "0000000000\n" //15
          + "0000000000\n" //16
          + "0000000000\n" //17
          + "1000000000\n" //18
          + "1140000000\n" //19
          // 0123456789
        );

        expect(f(m, 0, 18, DetrominoType.L)).toBeFalsy();
      });

      test("Not enough original blocks", () => {
        const m = toMatrix(
          // 0123456789
          "  0000000000\n" //0
          + "0000000000\n" //1
          + "0000000000\n" //2
          + "0000000000\n" //3
          + "0000000000\n" //4
          + "0000000000\n" //5
          + "0000000000\n" //6
          + "0000000000\n" //7
          + "0000000000\n" //8
          + "0000000000\n" //9
          + "0000000000\n" //10
          + "0000000000\n" //11
          + "0000000000\n" //12
          + "0000000000\n" //13
          + "0000000000\n" //14
          + "0000000000\n" //15
          + "4000000000\n" //16
          + "4110000000\n" //17
          + "0000000000\n" //18
          + "1000000000\n" //19
          // 0123456789
        );

        expect(f(m, 0, 16, DetrominoType.L)).toBeFalsy();
      });
    });

    test("Expect false: enough original blocks but not continuous", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "4000000000\n" //14
        + "4110000000\n" //15
        + "0000000000\n" //16
        + "1000000000\n" //17
        + "0000000000\n" //18
        + "1000000000\n" //19
        // 0123456789
      );

      expect(f(m, 0, 14, DetrominoType.L)).toBeFalsy();
    });

    test("Expect false: enough original blocks but not continuous (2)", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "4000000000\n" //13
        + "4110000000\n" //14
        + "0000000000\n" //15
        + "1000000000\n" //16
        + "0000000000\n" //17
        + "1000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      expect(f(m, 0, 13, DetrominoType.L)).toBeFalsy();
    });

    test("Expect false: floating matched blocks", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "4000000000\n" //14
        + "4110000000\n" //15
        + "0000000000\n" //16
        + "1000000000\n" //17
        + "1000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      expect(f(m, 0, 14, DetrominoType.L)).toBeFalsy();
    });

    test("Expect false: floating matched blocks (2)", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "4000000000\n" //14
        + "4110000000\n" //15
        + "1000000000\n" //16
        + "1000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      expect(f(m, 0, 14, DetrominoType.L)).toBeFalsy();
    });

    test("Expect false: all detromino are targets", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "4000000000\n" //15
        + "4440000000\n" //16
        + "0000000000\n" //17
        + "1000000000\n" //18
        + "1110000000\n" //19
        // 0123456789
      );

      expect(f(m, 0, 15, DetrominoType.L)).toBeFalsy();
    });

    test("Expect false: multiple columns", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "4000000000\n" //15
        + "4140000000\n" //16
        + "1000000000\n" //17
        + "1010000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      expect(f(m, 0, 15, DetrominoType.L)).toBeFalsy();
    });

    test("Expect false: some rows are good but some are not", () => {
      const m = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0040000000\n" //15
        + "0044100000\n" //16
        + "0000000000\n" //17
        + "0010000000\n" //18
        + "0010000000\n" //19
        // 0123456789
      );

      expect(f(m, 2, 15, DetrominoType.L)).toBeFalsy();
    });

    describe("Expect true: good examples", () => {

      test("One matched target detromino", () => {
        const m = toMatrix(
          // 0123456789
          "  0000000000\n" //0
          + "0000000000\n" //1
          + "0000000000\n" //2
          + "0000000000\n" //3
          + "0000000000\n" //4
          + "0000000000\n" //5
          + "0000000000\n" //6
          + "0000000000\n" //7
          + "0000000000\n" //8
          + "0000000000\n" //9
          + "0000000000\n" //10
          + "0000000000\n" //11
          + "0000000000\n" //12
          + "0000000000\n" //13
          + "0000000000\n" //14
          + "0000000000\n" //15
          + "0004000000\n" //16
          + "0001110000\n" //17
          + "0000000000\n" //18
          + "0001000000\n" //19
          // 0123456789
        );

        expect(f(m, 3, 16, DetrominoType.L)).toBeTruthy();
      });

      test("Two matched target detromino", () => {
        const m = toMatrix(
          // 0123456789
          "  0000000000\n" //0
          + "0000000000\n" //1
          + "0000000000\n" //2
          + "0000000000\n" //3
          + "0000000000\n" //4
          + "0000000000\n" //5
          + "0000000000\n" //6
          + "0000000000\n" //7
          + "0000000000\n" //8
          + "0000000000\n" //9
          + "0000000000\n" //10
          + "0000000000\n" //11
          + "0000000000\n" //12
          + "0000000000\n" //13
          + "0000000000\n" //14
          + "0000000000\n" //15
          + "0004000000\n" //16
          + "0004110000\n" //17
          + "0001000000\n" //18
          + "0001000000\n" //19
          // 0123456789
        );

        expect(f(m, 3, 16, DetrominoType.L)).toBeTruthy();
      });

      test("Matched detrominos in different columns", () => {
        const m = toMatrix(
          // 0123456789
          "  0000000000\n" //0
          + "0000000000\n" //1
          + "0000000000\n" //2
          + "0000000000\n" //3
          + "0000000000\n" //4
          + "0000000000\n" //5
          + "0000000000\n" //6
          + "0000000000\n" //7
          + "0000000000\n" //8
          + "0000000000\n" //9
          + "0000000000\n" //10
          + "0000000000\n" //11
          + "0000000000\n" //12
          + "0000000000\n" //13
          + "0000000000\n" //14
          + "0000000000\n" //15
          + "0000100000\n" //16
          + "0004140000\n" //17
          + "0000010000\n" //18
          + "0001110000\n" //19
          // 0123456789
        );

        expect(f(m, 3, 16, DetrominoType.T)).toBeTruthy();
      });

      test("Matched detrominos in all columns", () => {
        const m = toMatrix(
          // 0123456789
          "  0000000000\n" //0
          + "0000000000\n" //1
          + "0000000000\n" //2
          + "0000000000\n" //3
          + "0000000000\n" //4
          + "0000000000\n" //5
          + "0000000000\n" //6
          + "0000000000\n" //7
          + "0000000000\n" //8
          + "0000000000\n" //9
          + "0000000000\n" //10
          + "0000000000\n" //11
          + "0000000000\n" //12
          + "0000000000\n" //13
          + "0000000000\n" //14
          + "0000100000\n" //15
          + "0004440000\n" //16
          + "0000000000\n" //17
          + "0001000000\n" //18
          + "0001110000\n" //19
          // 0123456789
        );

        expect(f(m, 3, 15, DetrominoType.T)).toBeTruthy();
      });
    });
  });
});

describe("Test sinkTargetBlocks", () => {
  // This function will probably only work for this test suite only
  function toGrid(matrix) {
    let grid = {};
    for (let blocks of matrix) {
      for (let block of blocks) {
        if (!block) {
          continue;
        }

        let id = `${block.get("x")}-${block.get("y")}`;
        grid[id] = block.set("id", id);
      }
    }

    return Immutable.Map(grid);
  }

  const f = (before, after) => {
    let gameGrid = toGrid(before);
    let result = gameGridToMatrixString(Algorithm.sinkTargetBlocks(gameGrid));
    expect(result).toBe(after.trim());
  };

  test("Nothing on the grid", () => {
    const before = toMatrix(
      // 0123456789
      "  0000000000\n" //0
      + "0000000000\n" //1
      + "0000000000\n" //2
      + "0000000000\n" //3
      + "0000000000\n" //4
      + "0000000000\n" //5
      + "0000000000\n" //6
      + "0000000000\n" //7
      + "0000000000\n" //8
      + "0000000000\n" //9
      + "0000000000\n" //10
      + "0000000000\n" //11
      + "0000000000\n" //12
      + "0000000000\n" //13
      + "0000000000\n" //14
      + "0000000000\n" //15
      + "0000000000\n" //16
      + "0000000000\n" //17
      + "0000000000\n" //18
      + "0000000000\n" //19
      // 0123456789
    );

    const after = (
      // 0123456789
      "  0000000000\n" //0
      + "0000000000\n" //1
      + "0000000000\n" //2
      + "0000000000\n" //3
      + "0000000000\n" //4
      + "0000000000\n" //5
      + "0000000000\n" //6
      + "0000000000\n" //7
      + "0000000000\n" //8
      + "0000000000\n" //9
      + "0000000000\n" //10
      + "0000000000\n" //11
      + "0000000000\n" //12
      + "0000000000\n" //13
      + "0000000000\n" //14
      + "0000000000\n" //15
      + "0000000000\n" //16
      + "0000000000\n" //17
      + "0000000000\n" //18
      + "0000000000\n" //19
      // 0123456789
    );

    f(before, after);
  });

  describe("Target blocks only", () => {

    test("Target blocks at the bottom", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0033303300\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0033303300\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Target blocks (stacked) at the bottom", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0030000000\n" //17
        + "0030003300\n" //18
        + "0033303300\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0030000000\n" //17
        + "0030003300\n" //18
        + "0033303300\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Target blocks floating", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0030003000\n" //17
        + "0000000000\n" //18
        + "0000003000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000003000\n" //18
        + "0030003000\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Target blocks (stacked) floating", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000030\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000003000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0030300000\n" //12
        + "0030000000\n" //13
        + "0030300000\n" //14
        + "0000000000\n" //15
        + "0000300030\n" //16
        + "0000003000\n" //17
        + "0000003000\n" //18
        + "0000000030\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0030303030\n" //17
        + "0030303030\n" //18
        + "0030303030\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Target blocks every column", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000033\n" //1
        + "0000000333\n" //2
        + "0000000000\n" //3
        + "0000330333\n" //4
        + "0000000000\n" //5
        + "0000300330\n" //6
        + "0000300000\n" //7
        + "0003303000\n" //8
        + "0003000333\n" //9
        + "0000000003\n" //10
        + "0003300000\n" //11
        + "0033000333\n" //12
        + "0030033000\n" //13
        + "0000003003\n" //14
        + "0330030330\n" //15
        + "0000030000\n" //16
        + "0300003003\n" //17
        + "0000033330\n" //18
        + "3000033003\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000003\n" //11
        + "0000000033\n" //12
        + "0000000333\n" //13
        + "0000033333\n" //14
        + "0000333333\n" //15
        + "0003333333\n" //16
        + "0033333333\n" //17
        + "0333333333\n" //18
        + "3333333333\n" //19
        // 0123456789
      );

      f(before, after);
    });
  });

  describe("Mixed with original blocks", () => {
    test("Original blocks at the bottom", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000300000\n" //16
        + "0000000000\n" //17
        + "0000003000\n" //18
        + "0011100000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000300000\n" //18
        + "0011103000\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Multiple levels of original blocks", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000030\n" //3
        + "0000000000\n" //4
        + "0000033000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0011111100\n" //12
        + "0000000000\n" //13
        + "0000330000\n" //14
        + "0000000000\n" //15
        + "0011111100\n" //16
        + "0030000000\n" //17
        + "0000000300\n" //18
        + "0011111100\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000033000\n" //11
        + "0011111100\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000330000\n" //15
        + "0011111100\n" //16
        + "0000000000\n" //17
        + "0030000300\n" //18
        + "0011111130\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Multiple levels of original blocks 2", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "3333333333\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0030011111\n" //5
        + "0000000000\n" //6
        + "1111100300\n" //7
        + "0000000000\n" //8
        + "0030011111\n" //9
        + "0030000000\n" //10
        + "1111133333\n" //11
        + "0003000000\n" //12
        + "0030011111\n" //13
        + "0300000330\n" //14
        + "1111100000\n" //15
        + "0000033300\n" //16
        + "0000011111\n" //17
        + "0033333333\n" //18
        + "1111100000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000033333\n" //4
        + "0030011111\n" //5
        + "3333300000\n" //6
        + "1111100000\n" //7
        + "0000000300\n" //8
        + "0030011111\n" //9
        + "0030000000\n" //10
        + "1111100000\n" //11
        + "0000033333\n" //12
        + "0000011111\n" //13
        + "0333000000\n" //14
        + "1111100300\n" //15
        + "0000033330\n" //16
        + "0000011111\n" //17
        + "0033300000\n" //18
        + "1111133333\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Multiple stacked levels of original blocks", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "3333333333\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0030011111\n" //5
        + "0000000000\n" //6
        + "1111100300\n" //7
        + "0000000000\n" //8
        + "0030011111\n" //9
        + "0030000000\n" //10
        + "1111133333\n" //11
        + "1111111111\n" //12
        + "0030011111\n" //13
        + "0300000330\n" //14
        + "1111100000\n" //15
        + "0000033300\n" //16
        + "0000011111\n" //17
        + "0033333333\n" //18
        + "1111100000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000033333\n" //4
        + "0030011111\n" //5
        + "3333300000\n" //6
        + "1111100000\n" //7
        + "0000000300\n" //8
        + "0030011111\n" //9
        + "0030000000\n" //10
        + "1111133333\n" //11
        + "1111111111\n" //12
        + "0000011111\n" //13
        + "0330000000\n" //14
        + "1111100300\n" //15
        + "0000033330\n" //16
        + "0000011111\n" //17
        + "0033300000\n" //18
        + "1111133333\n" //19
        // 0123456789
      );

      f(before, after);
    });
  });

});

describe("Test applyDetrominoBlocks (original only)", () => {
  // This function will probably only work for this test suite only
  function toGrid(matrix) {
    let grid = {};
    for (let blocks of matrix) {
      for (let block of blocks) {
        if (!block) {
          continue;
        }

        let id = `${block.get("x")}-${block.get("y")}`;
        grid[id] = block.set("id", id);
      }
    }

    return Immutable.Map(grid);
  }

  const f = (before, after) => {
    let gameGrid = toGrid(before);
    let result = gameGridToMatrixString(Algorithm.applyDetrominoBlocks(gameGrid));
    expect(result).toBe(after.trim());
  };

  describe("Blank grid", () => {
    test("Flat I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0022220000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0033330000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Vertical I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000020000\n" //16
        + "0000020000\n" //17
        + "0000020000\n" //18
        + "0000020000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000030000\n" //16
        + "0000030000\n" //17
        + "0000030000\n" //18
        + "0000030000\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Horizontal Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000002200\n" //16
        + "0000000220\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000003300\n" //16
        + "0000000330\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Vertical Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0020000000\n" //17
        + "0220000000\n" //18
        + "0200000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0030000000\n" //17
        + "0330000000\n" //18
        + "0300000000\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("L", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000020000\n" //17
        + "0000022200\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000030000\n" //17
        + "0000033300\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("O", () => {
      const before = toMatrix(
        // 0123456789
        "  2200000000\n" //0
        + "2200000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  3300000000\n" //0
        + "3300000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    });
  });

  describe("One level at the bottom", () => {
    test("Flat I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0002222000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "1111111111\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "1115555111\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Vertical I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0200000000\n" //14
        + "0200000000\n" //15
        + "0200000000\n" //16
        + "0200000000\n" //17
        + "0000000000\n" //18
        + "1111111111\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0300000000\n" //16
        + "0300000000\n" //17
        + "0300000000\n" //18
        + "1511111111\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Horizontal Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000022000\n" //17
        + "0000002200\n" //18
        + "1111111111\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000033000\n" //18
        + "1111115511\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("Vertical Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000200000\n" //13
        + "0002200000\n" //14
        + "0002000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "1111111111\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000300000\n" //17
        + "0003300000\n" //18
        + "1115111111\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("L", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000002\n" //15
        + "0000000222\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "1111111111\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000003\n" //18
        + "1111111555\n" //19
        // 0123456789
      );

      f(before, after);
    });

    test("O", () => {
      const before = toMatrix(
        // 0123456789
        "  0000220000\n" //0
        + "0000220000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "1111111111\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000330000\n" //18
        + "1111551111\n" //19
        // 0123456789
      );

      f(before, after);
    });
  });

  describe("One level (non-continuous) at the bottom", () => {
    test("Flat I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Horizontal Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("L", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("O", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
  })

  describe("Two levels at the bottom", () => {
    test("Flat I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Horizontal Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("L", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("O", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
  })

  describe("One level hovering", () => {
    test("Flat I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Horizontal Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("L", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("O", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
  })

  describe("Solid multiple levels", () => {
    test("Flat I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Horizontal Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("L", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("O", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
  })

  describe("Stairs", () => {
    test("Flat I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Horizontal Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("L", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("O", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
  })

  describe("Spotted grid", () => {
    test("Flat I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical I", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Horizontal Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("Vertical Z", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("L", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
    test("O", () => {
      const before = toMatrix(
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      const after = (
        // 0123456789
        "  0000000000\n" //0
        + "0000000000\n" //1
        + "0000000000\n" //2
        + "0000000000\n" //3
        + "0000000000\n" //4
        + "0000000000\n" //5
        + "0000000000\n" //6
        + "0000000000\n" //7
        + "0000000000\n" //8
        + "0000000000\n" //9
        + "0000000000\n" //10
        + "0000000000\n" //11
        + "0000000000\n" //12
        + "0000000000\n" //13
        + "0000000000\n" //14
        + "0000000000\n" //15
        + "0000000000\n" //16
        + "0000000000\n" //17
        + "0000000000\n" //18
        + "0000000000\n" //19
        // 0123456789
      );

      f(before, after);
    })
  })

});